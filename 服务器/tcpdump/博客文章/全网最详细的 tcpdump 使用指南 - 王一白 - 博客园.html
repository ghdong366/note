<!DOCTYPE html>
<!-- saved from url=(0069)https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html -->
<html lang="zh-cn" style="--olcb-folder-code-block-max-height:80vh;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="never">
    <meta name="description" content="没有难抓的包，只有用不好 tcpdump 的人">
    <meta property="og:description" content="没有难抓的包，只有用不好 tcpdump 的人">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>全网最详细的 tcpdump 使用指南 - 王一白 - 博客园</title>
    <link id="favicon" rel="shortcut icon" href="https://common.cnblogs.com/favicon.svg" type="image/svg+xml">
    
    <style>#home :not(.cnblogs_code):not(.cnblogs_Highlighter)>pre:not([highlighted]):not([class*="brush:"]) code:not(.hljs), :not(.cnblogs_code):not(.cnblogs_Highlighter)>pre:not([highlighted]):not([class*="brush:"]) code:not(.hljs) {background: rgb(245, 245, 245);
        padding: 12px;
        border: 1px solid rgb(204, 204, 204);
        border-radius: 3px;
        border-color: transparent;
        color: rgb(248, 248, 242);
        font-family: "Courier New", sans-serif;
        font-size: 12px</style><link rel="stylesheet" href="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/blog-common.min.css">
    <link id="MainCss" rel="stylesheet" href="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/bundle-custom.min.css">
        <link id="highlighter-theme-cnblogs" type="text/css" rel="stylesheet" href="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/cnblogs.css">
    <link type="text/css" rel="stylesheet" href="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/custom.css">
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/bundle-custom-mobile.min.css">
    
    
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/wongbingming/rss">
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/wongbingming/rsd.xml">
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/wongbingming/wlwmanifest.xml">
    <script type="text/javascript" async="" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/analytics.js.下载"></script><script>
        var currentBlogId = 351991;
        var currentBlogApp = 'wongbingming';
        var isLogined = false;
        var isBlogOwner = false;
        var skinName = 'Custom';
        var visitorUserId = '';
        var hasCustomScript = true;
        try {
            if (hasCustomScript && document.referrer && document.referrer.indexOf('baidu.com') >= 0) {
                Object.defineProperty(document, 'referrer', { value: '' });
                Object.defineProperty(Document.prototype, 'referrer', { get: function(){ return ''; } });
            }
        } catch(error) { }
        window.cb_enable_mathjax = false;
        window.mathEngine = 0;
        window.codeHighlightEngine = 1;
        window.enableCodeLineNumber = false;
        window.codeHighlightTheme = 'cnblogs';
        window.darkModeCodeHighlightTheme = 'vs2015';
        window.isDarkCodeHighlightTheme = false;
        window.isDarkModeCodeHighlightThemeDark = true;
        window.isDisableCodeHighlighter = false;
        window.enableCodeThemeTypeFollowSystem = false;
    </script>
        <script>
            var currentPostDateAdded = '2020-06-30 10:26';
        </script>
    <script src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/jquery-2.2.0.min.js.下载"></script>
    <script src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/blog-common.min.js.下载"></script><style>.medium-zoom-overlay {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  opacity: 0;
  transition: opacity 300ms;
  will-change: opacity;
}

.medium-zoom--opened .medium-zoom-overlay {
  cursor: pointer;
  cursor: zoom-out;
  opacity: 1;
}

.medium-zoom-image {
  cursor: pointer;
  cursor: zoom-in;
  /*
    The `transition` is marked as "!important" for the animation to happen
    even though it's overriden by another inline `transition` style attribute.

    This is problematic with frameworks that generate inline styles on their
    images (e.g. Gatsby).

    See https://github.com/francoischalifour/medium-zoom/issues/110
   */
  transition: transform 300ms cubic-bezier(0.2, 0, 0.2, 1) !important;
}

.medium-zoom-image--hidden {
  visibility: hidden;
}

.medium-zoom-image--opened {
  position: relative;
  cursor: pointer;
  cursor: zoom-out;
  will-change: transform;
}
</style><script id="hljs-script" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/highlight.min.js.下载" type="text/javascript" async=""></script>
    
<meta http-equiv="origin-trial" content="AzoawhTRDevLR66Y6MROu167EDncFPBvcKOaQispTo9ouEt5LvcBjnRFqiAByRT+2cDHG1Yj4dXwpLeIhc98/gIAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjYxMjk5MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A6+nc62kbJgC46ypOwRsNW6RkDn2x7tgRh0wp7jb3DtFF7oEhu1hhm4rdZHZ6zXvnKZLlYcBlQUImC4d3kKihAcAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjYxMjk5MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/9La288e7MDEU2ifusFnMg1C2Ij6uoa/Z/ylwJIXSsWfK37oESIPbxbt4IU86OGqDEPnNVruUiMjfKo65H/CQwAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjYxMjk5MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><script src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/pubads_impl_2022072702.js.下载" async=""></script><link rel="preload" href="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/f.txt" as="script"><script type="text/javascript" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/f.txt"></script></head>
<body class="skin-custom no-navbar hljs-engine"><div class="esa-mobile-menu"></div><div class="esa-mobile-menu"></div>
<a name="top"></a>
<div id="top_nav" class="navbar forpc navbar-custom">
    <nav id="nav_main" class="navbar-main">
        <ul id="nav_left" class="navbar-list navbar-left">
            <li class="navbar-branding">
                <a href="https://www.cnblogs.com/" title="开发者的网上家园" role="banner">
                    <img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/logo.svg" alt="博客园Logo">
                </a>
            </li>
            <li>
                <a href="https://www.cnblogs.com/" onclick="countClicks(&#39;skin-navbar-sitehome&#39;)">首页</a>
            </li>
            <li>
                <a href="https://news.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-news&#39;)">新闻</a>
            </li>
            <li>
                <a href="https://q.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-q&#39;)">博问</a>
            </li>
            <li>
                <a id="nav_brandzone" href="https://brands.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-brands&#39;)">专区</a>
            </li>
            <li>
                <a href="https://ing.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-ing&#39;)">闪存</a>
            </li>
            <li>
                <a href="https://edu.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-edu&#39;)">班级</a>
            </li>
        </ul>
        <ul id="nav_right" class="navbar-list navbar-right">
            <li>
                <form id="zzk_search" class="navbar-search" action="https://zzk.cnblogs.com/s" method="get" role="search">
                    <input name="w" id="zzk_search_input" placeholder="代码改变世界" type="search" tabindex="3">
                    <button type="submit" id="zzk_search_button">
                        <img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/search.svg" alt="搜索">
                    </button>
                </form>
            </li>
            <li id="navbar_login_status" class="navbar-list">
                <a class="navbar-user-info navbar-blog" href="https://i.cnblogs.com/EditPosts.aspx?opt=1" alt="写随笔" title="写随笔" style="display: none;">
                    <img id="new_post_icon" class="navbar-icon" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/newpost.svg" alt="写随笔">
                </a>
                <a id="navblog-myblog-icon" class="navbar-user-info navbar-blog" href="https://passport.cnblogs.com/GetBlogApplyStatus.aspx" alt="我的博客" title="我的博客" style="display: none;">
                    <img id="myblog_icon" class="navbar-icon" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/myblog.svg" alt="我的博客">
                </a>
                <a class="navbar-user-info navbar-message navbar-icon-wrapper" href="https://msg.cnblogs.com/" alt="短消息" title="短消息" style="display: none;">
                    <img id="msg_icon" class="navbar-icon" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/message.svg" alt="短消息">
                    <span id="msg_count" style="display: none"></span>
                </a>
                <a id="navbar_lite_mode_indicator" data-current-page="blog" style="display: none" href="javascript:void(0)" alt="简洁模式" title="简洁模式启用，您在访问他人博客时会使用简洁款皮肤展示">
                    <img class="navbar-icon" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/lite-mode-on.svg" alt="简洁模式">
                </a>
                <div id="user_info" class="navbar-user-info dropdown" style="display: none;">
                    <a class="dropdown-button" href="https://home.cnblogs.com/">
                        <img id="user_icon" class="navbar-avatar" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/avatar-default.svg" alt="用户头像">
                    </a>
                    <div class="dropdown-menu">
                        <a id="navblog-myblog-text" href="https://passport.cnblogs.com/GetBlogApplyStatus.aspx">我的博客</a>
                        <a href="https://home.cnblogs.com/">我的园子</a>
                        <a href="https://account.cnblogs.com/settings/account">账号设置</a>
                        <a href="javascript:void(0)" id="navbar_lite_mode_toggle" title="简洁模式会使用简洁款皮肤显示所有博客">
    简洁模式 <img id="navbar_lite_mode_on" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/lite-mode-check.svg" class="hide"><span id="navbar_lite_mode_spinner" class="hide">...</span>
</a>
                        <a href="javascript:void(0)" onclick="account.logout();">退出登录</a>
                    </div>
                </div>
                <a class="navbar-anonymous" href="https://account.cnblogs.com/signup" style="display: inline;">注册</a>
                <a class="navbar-anonymous" href="javascript:void(0);" onclick="account.login()" style="display: inline;">登录</a>
            </li>
        </ul>
    </nav>
</div>



<!--done-->
<div id="home">
<div id="header" style="display: block;">
	<div id="blogTitle">
        <a id="lnkBlogLogo" href="https://www.cnblogs.com/wongbingming/"><img id="blogLogo" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/logo.gif" alt="返回主页"></a>		
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/wongbingming/">写代码的明哥</a>
</h1>
<h2>专注分享Python开发知识</h2>




		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">
博客园</a>
<i></i><i></i></li>
<li>
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/wongbingming/">
首页</a>
<i></i><i></i></li><li><a id="blog_nav_tags" class="menu" href="https://www.cnblogs.com/wongbingming/tag">标签</a><i></i></li><li><a id="blog_nav_tags" class="menu" href="https://www.cnblogs.com/wongbingming/tag">标签</a><i></i><i></i></li>
<li>

<a id="blog_nav_newpost" class="menu" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">
新随笔</a>
<i></i><i></i></li>
<li>
<a id="blog_nav_contact" class="menu" href="https://msg.cnblogs.com/send/%E7%8E%8B%E4%B8%80%E7%99%BD">
联系</a><i></i><i></i></li>
<li>
<a id="blog_nav_rss" class="menu" href="javascript:void(0)" data-rss="https://www.cnblogs.com/wongbingming/rss/">
订阅</a>
<!--<partial name="./Shared/_XmlLink.cshtml" model="Model" /></li>--><i></i><i></i></li>
<li>
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/">
管理</a>
<i></i><i></i></li>
</ul>


		<div class="blogStats">
			<span id="stats_post_count">随笔 - 188&nbsp; </span>
<span id="stats_article_count">文章 - 13&nbsp; </span>
<span id="stats-comment_count">评论 - 77&nbsp; </span>
<span id="stats-total-view-count">阅读 - 
<span title="总阅读数: 661738">
66万</span></span>

		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->
<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		<div id="post_detail">
    <!--done-->
    <div id="topics">
        <div class="post">
            <h1 class="postTitle">
                
<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/wongbingming/p/13212306.html">
    <span role="heading" aria-level="2">全网最详细的 tcpdump 使用指南</span>
    
</a><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        没有难抓的包，只有用不好 tcpdump 的人
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20200602135014.png" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>今天要给大家介绍的一个 Unix 下的一个 <strong>网络数据采集分析工具</strong>，也就是我们常说的抓包工具。</p>
<p>与它功能类似的工具有 wireshark ，不同的是，wireshark 有图形化界面，而 tcpdump 则只有命令行。</p>
<p>由于我本人更习惯使用命令行的方式进行抓包，因此今天先跳过 wireshark，直接给大家介绍这个 tcpdump 神器。</p>
<p>这篇文章，我肝了好几天，借助于Linux 的 man 帮助命令，我把 tcpdump 的用法全部研究了个遍，才形成了本文，不夸张的说，应该可以算是中文里把 tcpdump 讲得最清楚明白，并且还最全的文章了（至少我从百度、谷歌的情况来看），所以本文值得你收藏分享，就怕你错过了，就再也找不到像这样把 tcpdump 讲得直白而且特全的文章了。</p>
<p><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20200630095709.png" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>在讲解之前，有两点需要声明：</p>
<ol>
<li>第三节到第六节里的 tcpdump 命令示例，只为了说明参数的使用，并不一定就能抓到包，如果要精准抓到你所需要的包，需要配合第五节的逻辑逻辑运算符进行组合搭配。</li>
<li>不同 Linux 发行版下、不同版本的 tcpdump 可能有小许差异， 本文是基于 CentOS 7.2 的 4.5.1 版本的tcpdump 进行学习的，若在你的环境中无法使用，请参考 <code>man tcpdump</code> 进行针对性学习。</li>
</ol>
<h2 id="idx_0"><span>1. tcpdump 核心参数图解<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_0" class="esa-anchor">#</a></h2>
<p>大家都知道，网络上的流量、数据包，非常的多，因此要想抓到我们所需要的数据包，就需要我们定义一个精准的过滤器，把这些目标数据包，从巨大的数据包网络中抓取出来。</p>
<p>所以学习抓包工具，其实就是学习如何定义过滤器的过程。</p>
<p>而在 tcpdump 的世界里，过滤器的实现，都是通过一个又一个的参数组合起来，一个参数不够精准，那就再加一个，直到我们能过滤掉无用的数据包，只留下我们感兴趣的数据包。</p>
<p>tcpdump 的参数非常的多，初学者在没有掌握 tcpdump 时，会对这个命令的众多参数产生很多的疑惑。</p>
<p>就比如下面这个命令，我们要通过 <code>host</code> 参数指定 host ip 进行过滤</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_0" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_0" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_0"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump host 192.168.10.100</span>
</code></pre>
<p><code>主程序</code> + <code>参数名</code>+ <code>参数值</code>  这样的组合才是我们正常认知里面命令行该有的样子。</p>
<p>可 tcpdump 却不走寻常路，我们居然还可以在 host 前再加一个限定词，来缩小过滤的范围？</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_1" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_1" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_1"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump src host 192.168.10.100</span>
</code></pre>
<p>从字面上理解，确实很容易理解，但是这不符合编写命令行程序的正常逻辑，导致我们会有所疑虑：</p>
<ol>
<li>
<p>除了 src ，dst，可还有其它可以用的限定词？</p>
</li>
<li>
<p>src，host 应该如何理解它们，叫参数名？不合适，因为 src 明显不合适。</p>
</li>
</ol>
<p>如果你在网上看到有关 tcpdump 的博客、教程，无一不是给你一个参数组合，告诉你这是实现了怎样的一个过滤器？这样的教学方式，很容易让你依赖别人的文章来使用 tcpdump，而不能将 tcpdump 这样神器消化，达到灵活应用，灵活搭配过滤器的效果。</p>
<p>上面加了 src 本身就颠覆了我们的认知，你可知道在 src 之前还可以加更多的条件，比如 tcp, udp, icmp 等词，在你之前的基础上再过滤一层。</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_2" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_2" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_2"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump tcp src host 192.168.10.100</span>
</code></pre>
<p>这种参数的不确定性，让大多数人对 tcpdump 的学习始终无法得其精髓。</p>
<p>因此，在学习 tcpdump 之前，我觉得有必要要先让你知道：<strong>tcpdump 的参数是如何组成的？这非常重要。</strong></p>
<p>为此，我画了一张图，方便你直观的理解 tcpdump 的各种参数：</p>
<p><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20200628111325.png" alt="" loading="lazy" class="medium-zoom-image"></p>
<ol>
<li>option 可选参数：将在后边一一解释。</li>
<li>proto 类过滤器：根据协议进行过滤，可识别的关键词有： tcp, udp, icmp, ip, ip6, arp, rarp,ether,wlan, fddi, tr, decnet</li>
<li>type 类过滤器：可识别的关键词有：host, net, port, portrange，这些词后边需要再接参数。</li>
<li>direction 类过滤器：根据数据流向进行过滤，可识别的关键字有：src, dst，同时你可以使用逻辑运算符进行组合，比如 src or dst</li>
</ol>
<p>proto、type、direction 这三类过滤器的内容比较简单，也最常用，因此我将其放在最前面，也就是 <strong>第三节：常规过滤规则</strong>一起介绍。</p>
<p>而 option 可选的参数非常多，有的甚至也不经常用到，因此我将其放到后面一点，也就是 <strong>第四节：可选参数解析</strong></p>
<p>当你看完前面六节，你对 tcpdump 的认识会上了一个台阶，至少能够满足你 80% 的使用需求。</p>
<p>你一定会问了，还有 20% 呢？</p>
<p>其实 tcpdump 还有一些过滤关键词，它不符合以上四种过滤规则，可能需要你单独记忆。关于这部分我会在 <strong>第六节：特殊过滤规则</strong> 里进行介绍。</p>
<h2 id="idx_1"><span>2. 理解 tcpdump 的输出<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_1" class="esa-anchor" style="opacity: 0;">#</a></h2>
<h3 id="idx_2"><span>2.1 输出内容结构<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_2" class="esa-anchor">#</a></h3>
<p>tcpdump 输出的内容虽然多，却很规律。</p>
<p>这里以我随便抓取的一个 tcp 包为例来看一下</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_3" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_3" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_3">21:26:49.013621 IP 172.20.20.1.15605 &gt; 172.20.20.2.5920: Flags [P.], seq 49:97, ack 106048, win 4723, length 48
</code></pre>
<p>从上面的输出来看，可以总结出：</p>
<ol>
<li>第一列：时分秒毫秒 21:26:49.013621</li>
<li>第二列：网络协议 IP</li>
<li>第三列：发送方的ip地址+端口号，其中172.20.20.1是 ip，而15605 是端口号</li>
<li>第四列：箭头 &gt;， 表示数据流向</li>
<li>第五列：接收方的ip地址+端口号，其中 172.20.20.2 是 ip，而5920 是端口号</li>
<li>第六列：冒号</li>
<li>第七列：数据包内容，包括Flags 标识符，seq 号，ack 号，win 窗口，数据长度 length，其中 [P.] 表示 PUSH 标志位为 1，更多标识符见下面</li>
</ol>
<h3 id="idx_3"><span>2.2 Flags 标识符<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_3" class="esa-anchor">#</a></h3>
<p>使用 tcpdump 抓包后，会遇到的 TCP 报文 Flags，有以下几种：</p>
<ul>
<li><code>[S]</code> : SYN（开始连接）</li>
<li><code>[P]</code> : PSH（推送数据）</li>
<li><code>[F]</code> : FIN （结束连接）</li>
<li><code>[R]</code> : RST（重置连接）</li>
<li><code>[.]</code> : 没有 Flag （意思是除上面四种类型外的其他情况，有可能是 ACK 也有可能是 URG）</li>
</ul>
<h2 id="idx_4"><span>3. 常规过滤规则<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_4" class="esa-anchor">#</a></h2>
<h3 id="idx_5"><span>3.1 基于IP地址过滤：host<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_5" class="esa-anchor" style="opacity: 0;">#</a></h3>
<p>使用 <code>host</code> 就可以指定 host ip 进行过滤</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_4" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_4" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_4"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump host 192.168.10.100</span>
</code></pre>
<p>数据包的 ip 可以再细分为源ip和目标ip两种</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_5" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_5" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_5"><span class="hljs-meta"># </span><span class="language-bash">根据源ip进行过滤</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump -i eth2 src 192.168.10.100</span>
<span class="hljs-meta">
# </span><span class="language-bash">根据目标ip进行过滤</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump -i eth2 dst 192.168.10.200</span>
</code></pre>
<h3 id="idx_6"><span>3.2 基于网段进行过滤：net<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_6" class="esa-anchor">#</a></h3>
<p>若你的ip范围是一个网段，可以直接这样指定</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_6" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_6" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_6"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump net 192.168.10.0/24</span>
</code></pre>
<p>网段同样可以再细分为源网段和目标网段</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_7" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_7" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_7"><span class="hljs-meta"># </span><span class="language-bash">根据源网段进行过滤</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump src net 192.168</span>
<span class="hljs-meta">
# </span><span class="language-bash">根据目标网段进行过滤</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump dst net 192.168</span>
</code></pre>
<h3 id="idx_7"><span>3.3 基于端口进行过滤：port<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_7" class="esa-anchor">#</a></h3>
<p>使用 <code>port</code> 就可以指定特定端口进行过滤</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_8" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_8" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_8"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump port 8088</span>
</code></pre>
<p>端口同样可以再细分为源端口，目标端口</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_9" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_9" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_9"><span class="hljs-meta"># </span><span class="language-bash">根据源端口进行过滤</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump src port 8088</span>
<span class="hljs-meta">
# </span><span class="language-bash">根据目标端口进行过滤</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump dst port 8088</span>
</code></pre>
<p>如果你想要同时指定两个端口你可以这样写</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_10" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_10" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_10"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump port 80 or port 8088</span>
</code></pre>
<p>但也可以简写成这样</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_11" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_11" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_11"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump port 80 or 8088</span>
</code></pre>
<p>如果你的想抓取的不再是一两个端口，而是一个范围，一个一个指定就非常麻烦了，此时你可以这样指定一个端口段。</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_12" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_12" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_12"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump portrange 8000-8080</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump src portrange 8000-8080</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump dst portrange 8000-8080</span>
</code></pre>
<p>对于一些常见协议的默认端口，我们还可以直接使用协议名，而不用具体的端口号</p>
<p>比如 http  == 80，https == 443 等</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_13" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_13" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_13"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump tcp port http</span>
</code></pre>
<h3 id="idx_8"><span>3.4 基于协议进行过滤：proto<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_8" class="esa-anchor">#</a></h3>
<p>常见的网络协议有：tcp, udp, icmp, http, ip,ipv6 等</p>
<p>若你只想查看 icmp 的包，可以直接这样写</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_14" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_14" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_14"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump icmp</span>
</code></pre>
<p>protocol 可选值：ip, ip6, arp, rarp, atalk, aarp, decnet, sca, lat, mopdl,  moprc,  iso,  stp, ipx,  or  netbeui</p>
<h3 id="idx_9"><span>3.5 基本IP协议的版本进行过滤<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_9" class="esa-anchor">#</a></h3>
<p>当你想查看 tcp 的包，你也许会这样子写</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_15" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_15" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_15"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump tcp</span>
</code></pre>
<p>这样子写也没问题，就是不够精准，为什么这么说呢？</p>
<p>ip 根据版本的不同，可以再细分为 IPv4 和 IPv6 两种，如果你只指定了 tcp，这两种其实都会包含在内。</p>
<p>那有什么办法，能够将 IPv4 和 IPv6 区分开来呢？</p>
<p>很简单，如果是 IPv4 的 tcp 包 ，就这样写（友情提示：数字 6 表示的是 tcp 在ip报文中的编号。）</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_16" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_16" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_16"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump <span class="hljs-string">'ip proto tcp'</span></span>
<span class="hljs-meta">
# </span><span class="language-bash">or</span>
<span class="hljs-meta">
$ </span><span class="language-bash">tcpdump ip proto 6</span>
<span class="hljs-meta">
# </span><span class="language-bash">or</span>
<span class="hljs-meta">
$ </span><span class="language-bash">tcpdump <span class="hljs-string">'ip protochain tcp'</span></span>
<span class="hljs-meta">
# </span><span class="language-bash">or</span> 
<span class="hljs-meta">
$ </span><span class="language-bash">tcpdump ip protochain 6</span>
</code></pre>
<p>而如果是 IPv6 的 tcp 包 ，就这样写</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_17" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_17" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_17"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump <span class="hljs-string">'ip6 proto tcp'</span></span>
<span class="hljs-meta">
# </span><span class="language-bash">or</span>
<span class="hljs-meta">
$ </span><span class="language-bash">tcpdump ip6 proto 6</span>
<span class="hljs-meta">
# </span><span class="language-bash">or</span>
<span class="hljs-meta">
$ </span><span class="language-bash">tcpdump <span class="hljs-string">'ip6 protochain tcp'</span></span>
<span class="hljs-meta">
# </span><span class="language-bash">or</span> 
<span class="hljs-meta">
$ </span><span class="language-bash">tcpdump ip6 protochain 6</span>
</code></pre>
<p>关于上面这几个命令示例，有两点需要注意：</p>
<ol>
<li>跟在 proto 和 protochain 后面的如果是 tcp, udp, icmp ，那么过滤器需要用引号包含，这是因为 tcp,udp, icmp 是 tcpdump 的关键字。</li>
<li>跟在ip 和 ip6 关键字后面的 proto 和 protochain 是两个新面孔，看起来用法类似，它们是否等价，又有什么区别呢？</li>
</ol>
<p>关于第二点，网络上没有找到很具体的答案，我只能通过 <code>man tcpdump</code> 的提示， 给出自己的个人猜测，但不保证正确。</p>
<p>proto 后面跟的 <code>&lt;protocol&gt;</code> 的关键词是固定的，只能是 ip, ip6, arp, rarp, atalk, aarp, decnet, sca, lat, mopdl,  moprc,  iso,  stp, ipx,  or  netbeui 这里面的其中一个。</p>
<p>而 protochain 后面跟的 protocol 要求就没有那么严格，它可以是任意词，只要 tcpdump 的 IP 报文头部里的 protocol 字段为 <code>&lt;protocol&gt;</code> 就能匹配上。</p>
<p>理论上来讲，下面两种写法效果是一样的</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_18" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_18" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_18"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump <span class="hljs-string">'ip &amp;&amp; tcp'</span></span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump <span class="hljs-string">'ip proto tcp'</span></span>
</code></pre>
<p>同样的，这两种写法也是一样的</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_19" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_19" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_19"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump <span class="hljs-string">'ip6 &amp;&amp; tcp'</span></span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump <span class="hljs-string">'ip6 proto tcp'</span></span>
</code></pre>
<h2 id="idx_10"><span>4. 可选参数解析<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_10" class="esa-anchor" style="opacity: 0;">#</a></h2>
<h3 id="idx_11"><span>4.1 设置不解析域名提升速度<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_11" class="esa-anchor" style="opacity: 0;">#</a></h3>
<ul>
<li><code>-n</code>：不把ip转化成域名，直接显示  ip，避免执行 DNS lookups 的过程，速度会快很多</li>
<li><code>-nn</code>：不把协议和端口号转化成名字，速度也会快很多。</li>
<li><code>-N</code>：不打印出host 的域名部分.。比如,，如果设置了此选现，tcpdump 将会打印'nic' 而不是 'nic.ddn.mil'.</li>
</ul>
<h3 id="idx_12"><span>4.2 过滤结果输出到文件<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_12" class="esa-anchor">#</a></h3>
<p>使用 tcpdump 工具抓到包后，往往需要再借助其他的工具进行分析，比如常见的 wireshark 。</p>
<p>而要使用wireshark ，我们得将 tcpdump 抓到的包数据生成到文件中，最后再使用 wireshark 打开它即可。</p>
<p>使用 <code>-w</code> 参数后接一个以 <code>.pcap</code> 后缀命令的文件名，就可以将 tcpdump 抓到的数据保存到文件中。</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_20" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_20" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_20"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump icmp -w icmp.pcap</span>
</code></pre>
<h3 id="idx_13"><span>4.3 从文件中读取包数据<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_13" class="esa-anchor">#</a></h3>
<p>使用 <code>-w</code> 是写入数据到文件，而使用 <code>-r</code> 是从文件中读取数据。</p>
<p>读取后，我们照样可以使用上述的过滤器语法进行过滤分析。</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_21" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_21" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_21"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump icmp -r all.pcap</span>
</code></pre>
<h3 id="idx_14"><span>4.4 控制详细内容的输出<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_14" class="esa-anchor">#</a></h3>
<ul>
<li><code>-v</code>：产生详细的输出. 比如包的TTL，id标识，数据包长度，以及IP包的一些选项。同时它还会打开一些附加的包完整性检测，比如对IP或ICMP包头部的校验和。</li>
<li><code>-vv</code>：产生比-v更详细的输出. 比如NFS回应包中的附加域将会被打印, SMB数据包也会被完全解码。（摘自网络，目前我还未使用过）</li>
<li><code>-vvv</code>：产生比-vv更详细的输出。比如 telent 时所使用的SB, SE 选项将会被打印, 如果telnet同时使用的是图形界面，其相应的图形选项将会以16进制的方式打印出来（摘自网络，目前我还未使用过）</li>
</ul>
<h3 id="idx_15"><span>4.5 控制时间的显示<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_15" class="esa-anchor" style="opacity: 0;">#</a></h3>
<ul>
<li><code>-t </code>：在每行的输出中不输出时间</li>
<li><code>-tt</code>：在每行的输出中会输出时间戳</li>
<li><code>-ttt</code>：输出每两行打印的时间间隔(以毫秒为单位)</li>
<li><code>-tttt</code>：在每行打印的时间戳之前添加日期的打印（此种选项，输出的时间最直观）</li>
</ul>
<h3 id="idx_16"><span>4.6 显示数据包的头部<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_16" class="esa-anchor">#</a></h3>
<ul>
<li><code>-x</code>：以16进制的形式打印每个包的头部数据（但不包括数据链路层的头部）</li>
<li><code>-xx</code>：以16进制的形式打印每个包的头部数据（包括数据链路层的头部）</li>
<li><code>-X</code>：以16进制和 ASCII码形式打印出每个包的数据(但不包括连接层的头部)，这在分析一些新协议的数据包很方便。</li>
<li><code>-XX</code>：以16进制和 ASCII码形式打印出每个包的数据(包括连接层的头部)，这在分析一些新协议的数据包很方便。</li>
</ul>
<h3 id="idx_17"><span>4.7 过滤指定网卡的数据包<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_17" class="esa-anchor">#</a></h3>
<ul>
<li><code>-i</code>：指定要过滤的网卡接口，如果要查看所有网卡，可以 <code>-i any</code></li>
</ul>
<h3 id="idx_18"><span>4.8 过滤特定流向的数据包<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_18" class="esa-anchor">#</a></h3>
<ul>
<li><code>-Q</code>： 选择是入方向还是出方向的数据包，可选项有：in, out, inout，也可以使用  --direction=[direction] 这种写法</li>
</ul>
<h3 id="idx_19"><span>4.9 其他常用的一些参数<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_19" class="esa-anchor">#</a></h3>
<ul>
<li>
<p><code>-A</code>：以ASCII码方式显示每一个数据包(不显示链路层头部信息). 在抓取包含网页数据的数据包时, 可方便查看数据</p>
</li>
<li>
<p><code>-l</code> : 基于行的输出，便于你保存查看，或者交给其它工具分析</p>
</li>
<li>
<p><code>-q</code> : 简洁地打印输出。即打印很少的协议相关信息, 从而输出行都比较简短.</p>
</li>
<li>
<p><code>-c</code> : 捕获 count 个包 tcpdump 就退出</p>
</li>
<li>
<p><code>-s</code> :  tcpdump 默认只会截取前 <code>96</code> 字节的内容，要想截取所有的报文内容，可以使用 <code>-s number</code>， <code>number</code> 就是你要截取的报文字节数，如果是 0 的话，表示截取报文全部内容。</p>
</li>
<li>
<p><code>-S</code> : 使用绝对序列号，而不是相对序列号</p>
</li>
<li>
<p><code>-C</code>：file-size，tcpdump 在把原始数据包直接保存到文件中之前, 检查此文件大小是否超过file-size. 如果超过了, 将关闭此文件,另创一个文件继续用于原始数据包的记录. 新创建的文件名与-w 选项指定的文件名一致, 但文件名后多了一个数字.该数字会从1开始随着新创建文件的增多而增加. file-size的单位是百万字节(nt: 这里指1,000,000个字节,并非1,048,576个字节, 后者是以1024字节为1k, 1024k字节为1M计算所得, 即1M=1024 ＊ 1024 ＝ 1,048,576)</p>
</li>
<li>
<p><code>-F</code>：使用file 文件作为过滤条件表达式的输入, 此时命令行上的输入将被忽略.</p>
</li>
</ul>
<h3 id="idx_20"><span>4.10 对输出内容进行控制的参数<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_20" class="esa-anchor">#</a></h3>
<ul>
<li><code>-D</code> : 显示所有可用网络接口的列表</li>
<li><code>-e</code> : 每行的打印输出中将包括数据包的数据链路层头部信息</li>
<li><code>-E</code> : 揭秘IPSEC数据</li>
<li><code>-L</code> ：列出指定网络接口所支持的数据链路层的类型后退出</li>
<li><code>-Z</code>：后接用户名，在抓包时会受到权限的限制。如果以root用户启动tcpdump，tcpdump将会有超级用户权限。</li>
<li><code>-d</code>：打印出易读的包匹配码</li>
<li><code>-dd</code>：以C语言的形式打印出包匹配码.</li>
<li><code>-ddd</code>：以十进制数的形式打印出包匹配码</li>
</ul>
<h2 id="idx_21"><span>5. 过滤规则组合<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_21" class="esa-anchor">#</a></h2>
<p>有编程基础的同学，对于下面三个逻辑运算符应该不陌生了吧</p>
<ul>
<li>and：所有的条件都需要满足，也可以表示为 <code>&amp;&amp;</code></li>
<li>or：只要有一个条件满足就可以，也可以表示为 <code>||</code></li>
<li>not：取反，也可以使用 <code>!</code></li>
</ul>
<p>举个例子，我想需要抓一个来自<code>10.5.2.3</code>，发往任意主机的3389端口的包</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_22" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_22" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_22"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump src 10.5.2.3 and dst port 3389</span>
</code></pre>
<p>当你在使用多个过滤器进行组合时，有可能需要用到括号，而括号在 shell 中是特殊符号，因为你需要使用引号将其包含。例子如下：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_23" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_23" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_23"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump <span class="hljs-string">'src 10.0.2.4 and (dst port 3389 or 22)'</span></span>
</code></pre>
<p>而在单个过滤器里，常常会判断一条件是否成立，这时候，就要使用下面两个符号</p>
<ul>
<li><code>=</code>：判断二者相等</li>
<li><code>==</code>：判断二者相等</li>
<li><code>!=</code>：判断二者不相等</li>
</ul>
<p>当你使用这两个符号时，tcpdump 还提供了一些关键字的接口来方便我们进行判断，比如</p>
<ul>
<li>if：表示网卡接口名、</li>
<li>proc：表示进程名</li>
<li>pid：表示进程 id</li>
<li>svc：表示 service class</li>
<li>dir：表示方向，in 和 out</li>
<li>eproc：表示 effective process name</li>
<li>epid：表示 effective process ID</li>
</ul>
<p>比如我现在要过滤来自进程名为 <code>nc</code> 发出的流经 en0 网卡的数据包，或者不流经 en0 的入方向数据包，可以这样子写</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_24" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_24" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_24"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump <span class="hljs-string">"( if=en0 and proc =nc ) || (if != en0 and dir=in)"</span></span>
</code></pre>
<h2 id="idx_22"><span>6. 特殊过滤规则<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_22" class="esa-anchor">#</a></h2>
<h3 id="idx_23"><span>5.1 根据 tcpflags 进行过滤<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_23" class="esa-anchor" style="opacity: 0;">#</a></h3>
<p>通过<a href="https://mp.weixin.qq.com/s?__biz=MzIzMzMzOTI3Nw==&amp;mid=2247488180&amp;idx=1&amp;sn=09526224732ebfcccb52847f27298c70&amp;chksm=e8867256dff1fb40c9f47bafd0e87a9237c5a9ebf33c8a3d0a598276b496d29cdaa3fbff8d26&amp;token=1970357830&amp;lang=zh_CN#rd" target="_blank" rel="noopener">上一篇文章</a>，我们知道了 tcp 的首部有一个标志位。</p>
<p><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20200606095627.png" alt="TCP 报文首部" loading="lazy" class="medium-zoom-image"></p>
<p>tcpdump 支持我们根据数据包的标志位进行过滤</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_25" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_25" title="复制代码">Copy</div><code class="highlighter-hljs hljs language-bash" id="copy_target_25">proto [ <span class="hljs-built_in">expr</span>:size ]
</code></pre>
<ul>
<li>
<p><code>proto</code>：可以是熟知的协议之一（如ip，arp，tcp，udp，icmp，ipv6）</p>
</li>
<li>
<p><code>expr</code>：可以是数值，也可以是一个表达式，表示与指定的协议头开始处的字节偏移量。</p>
</li>
<li>
<p><code>size</code>：是可选的，表示从字节偏移量开始取的字节数量。</p>
</li>
</ul>
<p>接下来，我将举几个例子，让人明白它的写法，不过在那之前，有几个点需要你明白，这在后面的例子中会用到：</p>
<p><strong>1、</strong>tcpflags 可以理解为是一个别名常量，相当于 13，它代表着与指定的协议头开头相关的字节偏移量，也就是标志位，所以 tcp[tcpflags] 等价于 tcp[13] ，对应下图中的报文位置。</p>
<p><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20200628222034.png" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><strong>2、</strong>tcp-fin, tcp-syn, tcp-rst, tcp-push, tcp-ack, tcp-urg 这些同样可以理解为别名常量，分别代表 1，2，4，8，16，32，64。这些数字是如何计算出来的呢？</p>
<p>以 tcp-syn 为例，你可以参照下面这张图，计算出来的值 是就是 2</p>
<p><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20200628222010.png" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>由于数字不好记忆，所以一般使用这样的“别名常量”表示。</p>
<p>因此当下面这个表达式成立时，就代表这个包是一个 syn 包。</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_26" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_26" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_26">tcp[tcpflags] == tcp-syn
</code></pre>
<p>要抓取特定数据包，方法有很多种。</p>
<p>下面以最常见的 syn包为例，演示一下如何用 tcpdump 抓取到 syn 包，而其他的类型的包也是同样的道理。</p>
<p>据我总结，主要有三种写法：</p>
<p>1、第一种写法：使用数字表示偏移量</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_27" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_27" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_27"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -i eth0 <span class="hljs-string">"tcp[13] &amp; 2 != 0"</span></span> 
</code></pre>
<p>2、第二种写法：使用别名常量表示偏移量</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_28" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_28" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_28"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -i eth0 <span class="hljs-string">"tcp[tcpflags] &amp; tcp-syn != 0"</span></span> 
</code></pre>
<p>3、第三种写法：使用混合写法</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_29" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_29" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_29"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -i eth0 <span class="hljs-string">"tcp[tcpflags] &amp; 2 != 0"</span></span> 
<span class="hljs-meta">
# </span><span class="language-bash">or</span>
<span class="hljs-meta">
$ </span><span class="language-bash">tcpdump -i eth0 <span class="hljs-string">"tcp[13] &amp; tcp-syn != 0"</span></span> 
</code></pre>
<p>如果我想同时捕获多种类型的包呢，比如 syn + ack 包</p>
<p>1、第一种写法</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_30" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_30" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_30"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -i eth0 <span class="hljs-string">'tcp[13] == 2 or tcp[13] == 16'</span></span>
</code></pre>
<p>2、第二种写法</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_31" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_31" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_31"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -i eth0 <span class="hljs-string">'tcp[tcpflags] == tcp-syn or tcp[tcpflags] == tcp-ack'</span></span>
</code></pre>
<p>3、第三种写法</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_32" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_32" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_32"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -i eth0 <span class="hljs-string">"tcp[tcpflags] &amp; (tcp-syn|tcp-ack) != 0"</span></span> 
</code></pre>
<p>4、第四种写法：注意这里是 单个等号，而不是像上面一样两个等号，18（syn+ack） = 2（syn） + 16（ack）</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_33" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_33" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_33"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -i eth0 <span class="hljs-string">'tcp[13] = 18'</span></span>
<span class="hljs-meta">
# </span><span class="language-bash">or</span>
<span class="hljs-meta">
$ </span><span class="language-bash">tcpdump -i eth0 <span class="hljs-string">'tcp[tcpflags] = 18'</span></span>
</code></pre>
<p>tcp 中有 类似 tcp-syn 的别名常量，其他协议也是有的，比如 icmp 协议，可以使用的别名常量有</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_34" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_34" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_34">icmp-echoreply, icmp-unreach, icmp-sourcequench, 
icmp-redirect, icmp-echo, icmp-routeradvert,
icmp-routersolicit, icmp-timx-ceed, icmp-paramprob, 
icmp-tstamp, icmp-tstampreply,icmp-ireq, 
icmp-ireqreply, icmp-maskreq, icmp-maskreply
</code></pre>
<h3 id="idx_24"><span>5.2  基于包大小进行过滤<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_24" class="esa-anchor">#</a></h3>
<p>若你想查看指定大小的数据包，也是可以的</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_35" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_35" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_35"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump less 32</span> 
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump greater 64</span> 
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump &lt;= 128</span>
</code></pre>
<h3 id="idx_25"><span>5.3 根据 mac 地址进行过滤<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_25" class="esa-anchor" style="opacity: 0;">#</a></h3>
<p>例子如下，其中 ehost 是记录在 /etc/ethers 里的 name</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_36" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_36" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_36"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump ether host [ehost]</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump ether dst	[ehost]</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump ether src	[ehost]</span>
</code></pre>
<h3 id="idx_26"><span>5.4 过滤通过指定网关的数据包<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_26" class="esa-anchor">#</a></h3>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_37" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_37" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_37"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump gateway [host]</span>
</code></pre>
<h3 id="idx_27"><span>5.5 过滤广播/多播数据包<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_27" class="esa-anchor">#</a></h3>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_38" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_38" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_38"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump ether broadcast</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump ether multicast</span>
<span class="hljs-meta">
$ </span><span class="language-bash">tcpdump ip broadcast</span>
<span class="hljs-meta">$ </span><span class="language-bash">tcpdump ip multicast</span>
<span class="hljs-meta">
$ </span><span class="language-bash">tcpdump ip6 multicast</span>
</code></pre>
<h2 id="idx_28"><span>7. 如何抓取到更精准的包？<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_28" class="esa-anchor" style="opacity: 0;">#</a></h2>
<p>先给你抛出一个问题：如果我只想抓取 HTTP 的 POST 请求该如何写呢？</p>
<p>如果只学习了上面的内容，恐怕你还是无法写法满足这个抓取需求的过滤器。</p>
<p>在学习之前，我先给出答案，然后再剖析一下，这个过滤器是如何生效的，居然能让我们对包内的内容进行判断。</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_39" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_39" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_39"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -s 0 -A -vv <span class="hljs-string">'tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4]'</span></span>
</code></pre>
<p>命令里的可选参数，在前面的内容里已经详细讲过了。这里不再细讲。</p>
<p>本节的重点是引号里的内容，看起来很复杂的样子。</p>
<p>将它逐一分解，我们只要先理解了下面几种用法，就能明白</p>
<ul>
<li>
<p><code>tcp[n]</code>：表示 tcp 报文里 第 n 个字节</p>
</li>
<li>
<p><code>tcp[n:c]</code>：表示 tcp 报文里从第n个字节开始取 c 个字节，tcp[12:1] 表示从报文的第12个字节（因为有第0个字节，所以这里的12其实表示的是13）开始算起取一个字节，也就是 8 个bit。查看 <a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol#TCP_segment_structure" target="_blank" rel="noopener">tcp 的报文首部结构</a>，可以得知这 8 个bit 其实就是下图中的红框圈起来的位置，而在这里我们只要前面 4个bit，也就是实际数据在整个报文首部中的偏移量。</p>
<p><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20200629085659.png" alt="" loading="lazy" class="medium-zoom-image"></p>
</li>
<li>
<p><code>&amp;</code>：是<a href="https://en.wikipedia.org/wiki/Bitwise_operation" target="_blank" rel="noopener">位运算</a>里的 and 操作符，比如 <code>0011 &amp; 0010 = 0010</code></p>
</li>
<li>
<p><code>&gt;&gt;</code>：是位运算里的右移操作，比如 <code>0111 &gt;&gt; 2 =  0001</code></p>
</li>
<li>
<p><code>0xf0</code>：是 10 进制的 240 的 16 进制表示，但对于位操作来说，10进制和16进制都将毫无意义，我们需要的是二进制，将其转换成二进制后是：11110000，这个数有什么特点呢？前面个 4bit 全部是 1，后面4个bit全部是0，往后看你就知道这个特点有什么用了。</p>
</li>
</ul>
<p>分解完后，再慢慢合并起来看</p>
<p>1、<code>tcp[12:1] &amp; 0xf0</code> 其实并不直观，但是我们将它换一种写法，就好看多了，假设 tcp 报文中的 第12 个字节是这样组成的 <code>10110000</code>，那么这个表达式就可以变成 10110110 &amp;&amp; 11110000 = 10110000，得到了 10110000 后，再进入下一步。</p>
<p>2、<code>tcp[12:1] &amp; 0xf0) &gt;&gt; 2</code> ：如果你不理解 tcp 报文首部里的数据偏移，请先点击这个前往我的<a href="https://mp.weixin.qq.com/s?__biz=MzIzMzMzOTI3Nw==&amp;mid=2247488180&amp;idx=1&amp;sn=09526224732ebfcccb52847f27298c70&amp;chksm=e8867256dff1fb40c9f47bafd0e87a9237c5a9ebf33c8a3d0a598276b496d29cdaa3fbff8d26&amp;token=1970357830&amp;lang=zh_CN#rd" target="_blank" rel="noopener">上一篇文章</a>，搞懂数据偏移的意义，否则我保证你这里会绝对会听懵了。</p>
<p><code>tcp[12:1] &amp; 0xf0) &gt;&gt; 2</code> 这个表达式实际是 <code>(tcp[12:1] &amp; 0xf0) &gt;&gt; 4 ) &lt;&lt; 2</code> 的简写形式。所以要搞懂 <code>tcp[12:1] &amp; 0xf0) &gt;&gt; 2</code> 只要理解了<code>(tcp[12:1] &amp; 0xf0) &gt;&gt; 4 ) &lt;&lt; 2</code>  就行了 。</p>
<p>从上一步我们算出了 <code>tcp[12:1] &amp; 0xf0</code>  的值其实是一个字节，也就是 8 个bit，但是你再回去看下上面的 tcp 报文首部结构图，表示数据偏移量的只有 4个bit，也就是说 上面得到的值 10110000，前面 4 位（1011）才是正确的偏移量，那么为了得到 1011，只需要将 10110000 右移4位即可，也就是 <code>tcp[12:1] &amp; 0xf0) &gt;&gt; 4</code>，至此我们是不是已经得出了实际数据的正确位置呢，很遗憾还没有，前一篇文章里我们讲到 Data Offset 的单位是 4个字节，因为要将 1011 乘以 4才可以，除以4在位运算中相当于左移2位，也就是 <code>&lt;&lt;2</code>，与前面的 <code>&gt;&gt;4</code> 结合起来一起算的话，最终的运算可以简化为 <code>&gt;&gt;2</code>。</p>
<p>至此，我们终于得出了实际数据开始的位置是 <code>tcp[12:1] &amp; 0xf0) &gt;&gt; 2</code> （单位是字节）。</p>
<p>找到了数据的起点后，可别忘了我们的目的是从数据中打到 HTTP 请求的方法，是 GET 呢 还是 POST ，或者是其他的？</p>
<p>有了上面的经验，我们自然懂得使用 <code>tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4]</code> 从数据开始的位置再取出四个字节，然后将结果与 <code>GET </code> （注意 GET最后还有个空格）的 16进制写法（也就是 <code>0x47455420</code>）进行比对。</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_40" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_40" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_40">0x47   --&gt;   71    --&gt;  G
0x45   --&gt;   69    --&gt;  E
0x54   --&gt;   84    --&gt;  T
0x20   --&gt;   32    --&gt;  空格
</code></pre>
<p><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20200629130407.png" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>如果相等，则该表达式为True，tcpdump 认为这就是我们所需要抓的数据包，将其输出到我们的终端屏幕上。</p>
<h2 id="idx_29"><span>8. 抓包实战应用例子<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_29" class="esa-anchor" style="opacity: 0;">#</a></h2>
<h3 id="idx_30"><span>8.1 提取 HTTP 的 User-Agent<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_30" class="esa-anchor">#</a></h3>
<p>从 HTTP 请求头中提取 HTTP 的 User-Agent：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_41" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_41" title="复制代码">Copy</div><code class="language-bash highlighter-hljs hljs" id="copy_target_41">$ tcpdump -nn -A -s1500 -l | grep <span class="hljs-string">"User-Agent:"</span>
</code></pre>
<p>通过 <code>egrep</code> 可以同时提取User-Agent 和主机名（或其他头文件）：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_42" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_42" title="复制代码">Copy</div><code class="language-bash highlighter-hljs hljs" id="copy_target_42">$ tcpdump -nn -A -s1500 -l | egrep -i <span class="hljs-string">'User-Agent:|Host:'</span>
</code></pre>
<h3 id="idx_31"><span>8.2 抓取 HTTP GET 和 POST 请求<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_31" class="esa-anchor" style="opacity: 0;">#</a></h3>
<p>抓取 HTTP GET 请求包：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_43" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_43" title="复制代码">Copy</div><code class="language-bash highlighter-hljs hljs" id="copy_target_43">$ tcpdump -s 0 -A -vv <span class="hljs-string">'tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x47455420'</span>

<span class="hljs-comment"># or</span>

$ tcpdump -vvAls0 | grep <span class="hljs-string">'GET'</span>
</code></pre>
<p>可以抓取 HTTP POST 请求包：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_44" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_44" title="复制代码">Copy</div><code class="language-bash highlighter-hljs hljs" id="copy_target_44">$ tcpdump -s 0 -A -vv <span class="hljs-string">'tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x504f5354'</span>

<span class="hljs-comment"># or </span>

$ tcpdump -vvAls0 | grep <span class="hljs-string">'POST'</span>
</code></pre>
<p>注意：该方法不能保证抓取到 HTTP POST 有效数据流量，因为一个 POST 请求会被分割为多个 TCP 数据包。</p>
<h3 id="idx_32"><span>8.3 找出发包数最多的 IP<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_32" class="esa-anchor" style="opacity: 0;">#</a></h3>
<p>找出一段时间内发包最多的 IP，或者从一堆报文中找出发包最多的 IP，可以使用下面的命令：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_45" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_45" title="复制代码">Copy</div><code class="language-bash highlighter-hljs hljs" id="copy_target_45">$ tcpdump -nnn -t -c 200 | <span class="hljs-built_in">cut</span> -f 1,2,3,4 -d <span class="hljs-string">'.'</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr | <span class="hljs-built_in">head</span> -n 20
</code></pre>
<ul>
<li><strong>cut -f 1,2,3,4 -d '.'</strong> : 以 <code>.</code> 为分隔符，打印出每行的前四列。即 IP 地址。</li>
<li><strong>sort | uniq -c</strong> : 排序并计数</li>
<li><strong>sort -nr</strong> : 按照数值大小逆向排序</li>
</ul>
<h3 id="idx_33"><span>8.4 抓取 DNS 请求和响应<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_33" class="esa-anchor">#</a></h3>
<p>DNS 的默认端口是 53，因此可以通过端口进行过滤</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_46" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_46" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_46"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -i any -s0 port 53</span>
</code></pre>
<h3 id="idx_34"><span>8.5 切割 pcap 文件<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_34" class="esa-anchor">#</a></h3>
<p>当抓取大量数据并写入文件时，可以自动切割为多个大小相同的文件。例如，下面的命令表示每 3600 秒创建一个新文件 <code>capture-(hour).pcap</code>，每个文件大小不超过 <code>200*1000000</code> 字节：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_47" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_47" title="复制代码">Copy</div><code class="language-bash highlighter-hljs hljs" id="copy_target_47">$ tcpdump  -w /tmp/capture-%H.pcap -G 3600 -C 200
</code></pre>
<p>这些文件的命名为 <code>capture-{1-24}.pcap</code>，24 小时之后，之前的文件就会被覆盖。</p>
<h3 id="idx_35"><span>8.6 提取 HTTP POST 请求中的密码<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_35" class="esa-anchor">#</a></h3>
<p>从 HTTP POST 请求中提取密码和主机名：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_48" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_48" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_48"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -s 0 -A -n -l | egrep -i <span class="hljs-string">"POST /|pwd=|passwd=|password=|Host:"</span></span>
</code></pre>
<h3 id="idx_36"><span>8.7 提取 HTTP 请求的 URL<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_36" class="esa-anchor">#</a></h3>
<p>提取 HTTP 请求的主机名和路径：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_49" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_49" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_49"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump -s 0 -v -n -l | egrep -i <span class="hljs-string">"POST /|GET /|Host:"</span></span>
</code></pre>
<h3 id="idx_37"><span>8.8 抓取 HTTP 有效数据包<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_37" class="esa-anchor">#</a></h3>
<p>抓取 80 端口的 HTTP 有效数据包，排除 TCP 连接建立过程的数据包（SYN / FIN / ACK）：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_50" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_50" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_50"><span class="hljs-meta">$ </span><span class="language-bash">tcpdump <span class="hljs-string">'tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)'</span></span>
</code></pre>
<h3 id="idx_38"><span>8.9 结合 Wireshark 进行分析<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_38" class="esa-anchor">#</a></h3>
<p>通常 <code>Wireshark</code>（或 tshark）比 tcpdump 更容易分析应用层协议。一般的做法是在远程服务器上先使用 <code>tcpdump</code> 抓取数据并写入文件，然后再将文件拷贝到本地工作站上用 <code>Wireshark</code> 分析。</p>
<p>还有一种更高效的方法，可以通过 ssh 连接将抓取到的数据实时发送给 Wireshark 进行分析。以 MacOS 系统为例，可以通过 <code>brew cask install wireshark</code> 来安装，然后通过下面的命令来分析：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_51" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_51" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_51"><span class="hljs-meta">$ </span><span class="language-bash">ssh root@remotesystem <span class="hljs-string">'tcpdump -s0 -c 1000 -nn -w - not port 22'</span> | /Applications/Wireshark.app/Contents/MacOS/Wireshark -k -i -</span>
</code></pre>
<p>例如，如果想分析 DNS 协议，可以使用下面的命令：</p>
<pre class="highlighter-hljs" highlighted="true"><div class="esa-clipboard-button" data-clipboard-target="#copy_target_52" title="复制代码">Copy</div><div class="esa-clipboard-button" data-clipboard-target="#copy_target_52" title="复制代码">Copy</div><code class="language-shell highlighter-hljs hljs" id="copy_target_52"><span class="hljs-meta">$ </span><span class="language-bash">ssh root@remotesystem <span class="hljs-string">'tcpdump -s0 -c 1000 -nn -w - port 53'</span> | /Applications/Wireshark.app/Contents/MacOS/Wireshark -k -i -</span>
</code></pre>
<p>抓取到的数据：</p>
<p><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20200210170101.png" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><code>-c</code> 选项用来限制抓取数据的大小。如果不限制大小，就只能通过 <code>ctrl-c</code> 来停止抓取，这样一来不仅关闭了 tcpdump，也关闭了 wireshark。</p>
<p>到这里，我已经将我所知道的 tcpdump 的用法全部说了一遍，如果你有认真地看完本文，相信会有不小的收获，掌握一个上手的抓包工具，对于以后我们学习网络、分析网络协议、以及定位网络问题，会很有帮助，而 tcpdump 是我推荐的一个抓包工具。</p>
<h2 id="idx_39"><span>9. 参考文章<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></span><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#idx_39" class="esa-anchor">#</a></h2>
<ol>
<li><a href="https://www.freebsd.org/cgi/man.cgi?query=tcpdump&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+7.2-RELEASE&amp;format=html" target="_blank" rel="noopener">FreeBSD Manual Pages About tcpdump</a></li>
<li><a href="https://www.cnblogs.com/ggjucheng/archive/2012/01/14/2322659.html" target="_blank" rel="noopener">Linux tcpdump命令详解</a></li>
<li><a href="http://team.jiunile.com/blog/2019/06/tcpdump.html" target="_blank" rel="noopener">一份快速实用的 tcpdump 命令参考手册</a></li>
<li><a href="https://fuckcloudnative.io/posts/tcpdump-examples/" target="_blank" rel="noopener">超详细的网络抓包神器 tcpdump 使用指南</a></li>
<li><a href="https://colobu.com/2019/07/16/a-tcpdump-tutorial-with-examples/" target="_blank" rel="noopener">[译]tcpdump 示例教程</a></li>
<li><a href="https://danielmiessler.com/study/tcpdump/" target="_blank" rel="noopener">[英]tcpdump 示例教程</a></li>
</ol>
<hr>
<p><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20200607174235.png" alt="" loading="lazy" class="medium-zoom-image"></p>

</div>
<div class="clear"></div>
<div id="blog_post_info_block" role="contentinfo">


    <div id="blog_post_info">
<div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(13212306,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
        <a id="green_channel_follow" onclick="follow(&#39;07e57221-9b21-e711-9fc1-ac853d9f53cc&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/wongbingming/" target="_blank"><img src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/20191016202502.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/wongbingming/">王一白</a><br>
            <a href="https://home.cnblogs.com/u/wongbingming/followers/">粉丝 - <span class="follower-count">276</span></a>
            <a href="https://home.cnblogs.com/u/wongbingming/followees/">关注 - <span class="following-count">2</span></a><br>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow" class="follow-tip">
                <a href="javascript:void(0);" onclick="follow(&#39;07e57221-9b21-e711-9fc1-ac853d9f53cc&#39;);return false;">+加关注</a>
    </div>
</div>
<div id="div_digg" style="width: 300px;"><div class="reward"><span class="rewardnum" id="reward_count"></span></div><div class="favorite" onclick="AddToWz(cb_entryId);return false;"><span class="favoritenum" id="favorite_count"></span></div><div class="favorite" onclick="AddToWz(cb_entryId);return false;"><span class="favoritenum" id="favorite_count"></span></div>
    <div class="diggit" onclick="votePost(13212306,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">5</span>
    </div>
    <div class="buryit" onclick="votePost(13212306,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>

<script type="text/javascript">
    currentDiggType = 0;
</script></div>
    <div class="clear"></div>
    <div id="post_next_prev">

    <a href="https://www.cnblogs.com/wongbingming/p/13155696.html" class="p_n_p_prefix">« </a> 上一篇：    <a href="https://www.cnblogs.com/wongbingming/p/13155696.html" data-featured-image="" title="发布于 2020-06-18 08:35">36. 图解：Go 语言的反射三定律，也没什么难的嘛</a>
    <br>
    <a href="https://www.cnblogs.com/wongbingming/p/13425660.html" class="p_n_p_prefix">» </a> 下一篇：    <a href="https://www.cnblogs.com/wongbingming/p/13425660.html" data-featured-image="" title="发布于 2020-08-03 12:53">我发现了个 Python 黑魔法，执行任意代码都会自动念上一段 『平安经』</a>

</div>
</div>
            </div>
            <div class="postDesc">posted @ 
<span id="post-date">2020-06-30 10:26</span>&nbsp;
<a href="https://www.cnblogs.com/wongbingming/">王一白</a>&nbsp;
阅读(<span id="post_view_count">13469</span>)&nbsp;
评论(<span id="post_comment_count">5</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=13212306" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(13212306);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: &#39;&#39;, targetType: &#39;blogPost&#39;, targetId: &#39;13212306&#39;, targetLink: &#39;https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html&#39;, title: &#39;全网最详细的 tcpdump 使用指南&#39; })">举报</a></div>
        </div>
	    
	    
    </div><!--end: topics 文章、评论容器-->
</div>

<script>
    var cb_entryId = 13212306, cb_entryCreatedDate = '2020-06-30 10:26', cb_postType = 1, cb_postTitle = '全网最详细的 tcpdump 使用指南';
    var allowComments = true, cb_blogId = 351991, cb_blogApp = 'wongbingming', cb_blogUserGuid = '07e57221-9b21-e711-9fc1-ac853d9f53cc';
    mermaidRender.render()
    markdown_highlight()
    zoomManager.apply("#cnblogs_post_body img:not(.code_img_closed):not(.code_img_opened)");
    updatePostStats(
            [cb_entryId],
            function(id, count) { $("#post_view_count").text(count) },
            function(id, count) { $("#post_comment_count").text(count) })
</script>
<a id="!comments"></a>
<div id="blog-comments-placeholder"></div>
<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#" onclick="return RefreshPage();">刷新页面</a><a href="https://www.cnblogs.com/wongbingming/archive/2020/06/30/13212306.html#top">返回顶部</a></div>
    <div id="comment_form_container" style="visibility: visible;"><div class="login_tips">
    登录后才能查看或发表评论，立即 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return account.login(&#39;!comments&#39;);">登录</a> 或者
    <a href="https://www.cnblogs.com/">逛逛</a> 博客园首页
</div>
</div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
        <div id="cnblogs_ch"><a href="https://curl.qcloud.com/k19RDMHo" target="_blank" onclick="gtag(&#39;event&#39;, &#39;click&#39;, {&#39;event_category&#39;: &#39;ad&#39;, &#39;event_label&#39;: &#39;T2-腾讯云&#39;})">【推荐】腾讯云多款云产品1折起，买云服务器送免费机器</a><br></div>
    <div id="opt_under_post"></div>
    <div id="cnblogs_c1" class="under-post-card">
            <div id="div-gpt-ad-1592365906576-0" style="width: 300px; height: 250px;" data-google-query-id="CM-OssPDp_kCFQVtvQodFzgGOg"><div id="google_ads_iframe_/1090369/C1_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1090369/C1_0" name="google_ads_iframe_/1090369/C1_0" title="3rd party ad content" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="1" style="border: 0px; vertical-align: bottom;" data-load-complete="true" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/saved_resource.html"></iframe></div></div>
    </div>
    <div id="under_post_card1"><div class="under-post-card">
<b>编辑推荐：</b>
<br>

· <a href="https://www.cnblogs.com/InCerry/p/Use-SourceGenerator-Logger.html" target="_blank">.NET性能优化-使用SourceGenerator-Logger记录日志</a>
    <br>
· <a href="https://www.cnblogs.com/AcAc-t/p/linux_watermark_and_kafka_batch_send.html" target="_blank">记一次 Linux server 偶发 CPU 飙升问题的跟进与解决</a>
    <br>
· <a href="https://www.cnblogs.com/huangxincheng/p/16524963.html" target="_blank">记一次 .NET 某智慧物流 WCS 系统 CPU 爆高分析</a>
    <br>
· <a href="https://www.cnblogs.com/InCerry/p/how-to-build-dotnet-image-with-trace-tool.html" target="_blank">如何创建一个带诊断工具的 .NET 镜像</a>
    <br>
· <a href="https://www.cnblogs.com/chanmufeng/p/16523365.html" target="_blank">说透缓存一致性与内存屏障</a>
    <br>
</div></div>
    <div id="under_post_card2"><div class="itnews under-post-card">
    <b>最新新闻</b>：
    <br>
 ·          <a href="https://news.cnblogs.com/n/725786/" target="_blank">照亮整个蛋白质宇宙：DeepMind“顺手”放的大招，要一举攻克渐冻人症</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/725785/" target="_blank">新势力7月交付成绩单：蔚小理掉出前列，赛力斯暴涨88倍</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/725784/" target="_blank">姚劲波拉不动快狗打车</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/725783/" target="_blank">幻核惊魂夜，腾讯敲醒“数藏人”</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/725782/" target="_blank">大众版暗网？闲鱼上的暗语你都懂吗</a>
        <br>
    » <a href="https://news.cnblogs.com/" title="IT 新闻" target="_blank">更多新闻...</a>
</div></div>
    <div id="HistoryToday" class="under-post-card"></div>
    <script type="text/javascript">
        var commentManager = new blogCommentManager();
        commentManager.renderComments(0);
        fixPostBody();

            window.tocManager.displayDisableTocTips = false;
            window.tocManager.generateToc();
            
                setTimeout(function() { countViews(cb_blogId, cb_entryId); }, 50);
            
            deliverT2();
            deliverC1C2();
            loadNewsAndKb();
            
                LoadPostCategoriesTags(cb_blogId, cb_entryId);
            
            LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
            GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
            loadOptUnderPost();
            GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
                </script>
</div>

	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->
	<div id="sideBar">
		<div id="sideBarMain">
			<div id="sidebar_news" class="newsItem"><!--done-->
<h3 class="catListTitle">公告</h3>

<div id="blog-news">
    <script type="text/javascript">window['__document_write_ajax_callbacks__']['5']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['6']();</script><script>window['__document_write_ajax_callbacks__']['1']();</script>
<script type="text/javascript">window['__document_write_ajax_callbacks__']['7']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['2']();</script>

<script type="text/javascript">window['__document_write_ajax_callbacks__']['8']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['3']();</script>
    <div id="profile_block">
        昵称：
        <a href="https://home.cnblogs.com/u/wongbingming/">
            王一白
        </a>
        <br>
        园龄：
        <a href="https://home.cnblogs.com/u/wongbingming/" title="入园时间：2017-04-15">
            5年3个月
        </a>
        <br>
        粉丝：
        <a class="follower-count" href="https://home.cnblogs.com/u/wongbingming/followers/">
            276
        </a>
        <br>
        关注：
        <a class="folowing-count" href="https://home.cnblogs.com/u/wongbingming/followees/">
            2
        </a>
        <div id="p_b_follow" class="follow-tip">
<a href="javascript:void(0)" onclick="follow(&#39;07e57221-9b21-e711-9fc1-ac853d9f53cc&#39;)">+加关注</a></div>
        <script type="text/javascript">window['__document_write_ajax_callbacks__']['9']();</script><script>window['__document_write_ajax_callbacks__']['4']();</script>
    </div>
</div>

</div>
<div id="sidebar_c3"></div>
			<div id="blog-calendar" style="">

<table id="blogCalendar" class="Cal" cellspacing="0" cellpadding="0" title="Calendar" border="0">
    <tbody>
        <tr>
            <td colspan="7">
                <table class="CalTitle" cellspacing="0" border="0">
                    <tbody>
                        <tr>
                            <td class="CalNextPrev">
                                <a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2022/07/02&#39;); return false;">&lt;</a>
                            </td>
                            <td align="center">2022年8月</td>
                            <td align="right" class="CalNextPrev">
                                <a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2022/09/02&#39;); return false;">&gt;</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    <tr>
        <th class="CalDayHeader" align="center" abbr="日" scope="col">日</th>
        <th class="CalDayHeader" align="center" abbr="一" scope="col">一</th>
        <th class="CalDayHeader" align="center" abbr="二" scope="col">二</th>
        <th class="CalDayHeader" align="center" abbr="三" scope="col">三</th>
        <th class="CalDayHeader" align="center" abbr="四" scope="col">四</th>
        <th class="CalDayHeader" align="center" abbr="五" scope="col">五</th>
        <th class="CalDayHeader" align="center" abbr="六" scope="col">六</th>
    </tr>
            <tr>
                            <td class="CalOtherMonthDay" align="center">31</td>
                        <td class="" align="center">
                            1
                        </td>
                        <td class="CalTodayDay" align="center">
                            2
                        </td>
                        <td class="" align="center">
                            3
                        </td>
                        <td class="" align="center">
                            4
                        </td>
                        <td class="" align="center">
                            5
                        </td>
                    <td class="CalWeekendDay" align="center">
                        6
                    </td>
            </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            7
                        </td>
                            <td class="" align="center">
                                8
                            </td>
                            <td class="" align="center">
                                9
                            </td>
                            <td class="" align="center">
                                10
                            </td>
                            <td class="" align="center">
                                11
                            </td>
                            <td class="" align="center">
                                12
                            </td>
                        <td class="CalWeekendDay" align="center">
                            13
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            14
                        </td>
                            <td class="" align="center">
                                15
                            </td>
                            <td class="" align="center">
                                16
                            </td>
                            <td class="" align="center">
                                17
                            </td>
                            <td class="" align="center">
                                18
                            </td>
                            <td class="" align="center">
                                19
                            </td>
                        <td class="CalWeekendDay" align="center">
                            20
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            21
                        </td>
                            <td class="" align="center">
                                22
                            </td>
                            <td class="" align="center">
                                23
                            </td>
                            <td class="" align="center">
                                24
                            </td>
                            <td class="" align="center">
                                25
                            </td>
                            <td class="" align="center">
                                26
                            </td>
                        <td class="CalWeekendDay" align="center">
                            27
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            28
                        </td>
                            <td class="" align="center">
                                29
                            </td>
                            <td class="" align="center">
                                30
                            </td>
                            <td class="" align="center">
                                31
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                1
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                2
                            </td>
                        <td class="CalOtherMonthDay" align="center">
                            3
                        </td>
                </tr>
                <tr>
                        <td class="CalOtherMonthDay" align="center">
                            4
                        </td>
                            <td class="CalOtherMonthDay" align="center">
                                5
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                6
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                7
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                8
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                9
                            </td>
                        <td class="CalOtherMonthDay" align="center">
                            10
                        </td>
                </tr>
    </tbody>
</table></div><script>loadBlogDefaultCalendar();</script>			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"><!-- 搜索 -->
<div id="sidebar_search" class="sidebar-block">
    <div id="sidebar_search" class="mySearch">
        <h3 class="catListTitle">搜索</h3>
        <div id="sidebar_search_box">
            <div id="widget_my_zzk" class="div_my_zzk">
                <input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk">
            </div>
            <div id="widget_my_google" class="div_my_zzk">
                <input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk">
            </div>
        </div>
    </div>
</div>

<!-- 常用链接 -->
<div id="sidebar_shortcut" class="sidebar-block"><div class="catListLink">
<h3 class="catListTitle">
常用链接
</h3>
<ul>
    <li><a href="https://www.cnblogs.com/wongbingming/p/" title="我的博客的随笔列表">我的随笔</a></li>
<li><a href="https://www.cnblogs.com/wongbingming/MyComments.html" title="我的发表过的评论列表">我的评论</a></li>
<li><a href="https://www.cnblogs.com/wongbingming/OtherPosts.html" title="我评论过的随笔列表">我的参与</a></li>
<li><a href="https://www.cnblogs.com/wongbingming/comments" title="我的博客的评论列表">最新评论</a></li>
<li><a href="https://www.cnblogs.com/wongbingming/tag/" title="我的博客的标签列表">我的标签</a></li>

</ul>
</div>

</div>

<!-- 最新随笔 -->


<!-- 我的标签 -->
<div id="sidebar_toptags" class="sidebar-block"><div class="catListTag">
<h3 class="catListTitle">我的标签</h3>
<ul>
        <li>
            <a href="https://www.cnblogs.com/wongbingming/tag/Python/">Python<span class="tag-count">(113)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/wongbingming/tag/PyCharm/">PyCharm<span class="tag-count">(31)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/wongbingming/tag/Go%E8%AF%AD%E8%A8%80/">Go语言<span class="tag-count">(13)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/wongbingming/tag/Golang/">Golang<span class="tag-count">(13)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/wongbingming/tag/Linux/">Linux<span class="tag-count">(10)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/wongbingming/tag/Flask/">Flask<span class="tag-count">(10)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/wongbingming/tag/Django/">Django<span class="tag-count">(9)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/wongbingming/tag/HTML/">HTML<span class="tag-count">(8)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/wongbingming/tag/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/">个人博客<span class="tag-count">(7)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/wongbingming/tag/WordPress/">WordPress<span class="tag-count">(7)</span></a>
        </li>
    <li>
        <a href="https://www.cnblogs.com/wongbingming/tag/">更多</a>
    </li>

</ul>
</div>

</div>

<!-- 积分与排名 -->


<!-- 随笔分类、随笔档案、文章分类、新闻分类、相册、链接 -->
<div id="sidebar_categories">

    <div id="sidebar_postarchive" class="catListPostArchive sidebar-block">
        <h3 class="catListTitle">
            
随笔档案


        </h3>

        <ul>

                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2022/03.html" class="category-item-link" rel="" target="">2022年3月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2021/11.html" class="category-item-link" rel="" target="">2021年11月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2021/10.html" class="category-item-link" rel="" target="">2021年10月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2021/03.html" class="category-item-link" rel="" target="">2021年3月(12)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2021/02.html" class="category-item-link" rel="" target="">2021年2月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2020/11.html" class="category-item-link" rel="" target="">2020年11月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2020/10.html" class="category-item-link" rel="" target="">2020年10月(19)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2020/09.html" class="category-item-link" rel="" target="">2020年9月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2020/08.html" class="category-item-link" rel="" target="">2020年8月(2)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2020/06.html" class="category-item-link" rel="" target="">2020年6月(17)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2020/05.html" class="category-item-link" rel="" target="">2020年5月(18)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2020/04.html" class="category-item-link" rel="" target="">2020年4月(10)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2020/03.html" class="category-item-link" rel="" target="">2020年3月(5)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2020/02.html" class="category-item-link" rel="" target="">2020年2月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2019/12.html" class="category-item-link" rel="" target="">2019年12月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2019/11.html" class="category-item-link" rel="" target="">2019年11月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2019/10.html" class="category-item-link" rel="" target="">2019年10月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2019/08.html" class="category-item-link" rel="" target="">2019年8月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2019/07.html" class="category-item-link" rel="" target="">2019年7月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2019/06.html" class="category-item-link" rel="" target="">2019年6月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2019/05.html" class="category-item-link" rel="" target="">2019年5月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2019/04.html" class="category-item-link" rel="" target="">2019年4月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2019/03.html" class="category-item-link" rel="" target="">2019年3月(2)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2019/02.html" class="category-item-link" rel="" target="">2019年2月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2018/07.html" class="category-item-link" rel="" target="">2018年7月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2018/06.html" class="category-item-link" rel="" target="">2018年6月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2018/05.html" class="category-item-link" rel="" target="">2018年5月(9)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2018/04.html" class="category-item-link" rel="" target="">2018年4月(2)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2017/07.html" class="category-item-link" rel="" target="">2017年7月(7)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2017/06.html" class="category-item-link" rel="" target="">2017年6月(5)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2017/05.html" class="category-item-link" rel="" target="">2017年5月(39)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/wongbingming/archive/2017/04.html" class="category-item-link" rel="" target="">2017年4月(3)</a>
 
                </li>                
            <li>
                <a href="javascript:void(0)" onclick="sideColumnManager.loadMore(this)">更多</a>
            </li>
        </ul>


    </div>    
</div>

<!-- 最新评论 -->
<!-- 阅读排行榜 -->
<div id="sidebar_topviewedposts" class="sidebar-block"><div class="catListView">
    <h3 class="catListTitle">
        <a href="https://www.cnblogs.com/wongbingming/most-viewed" class="sidebar-card-title-a">
    阅读排行榜
</a>

    </h3>
    <div id="TopViewPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/wongbingming/p/6848701.html">
                            1. Python强大的格式化format(55754)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/wongbingming/p/6802660.html">
                            2. Flask入门之上传文件到服务器(39740)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/wongbingming/p/9085268.html">
                            3. Python并发编程之深入理解yield from语法（八）(38318)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/wongbingming/p/9028851.html">
                            4. Python并发编程之创建多线程的几种方法（二）(29147)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/wongbingming/p/6829481.html">
                            5. MySQL下载安装配置和Navicat for MySQL的安装配置(26817)
                        </a>
                    </li>
        </ul>
    </div>
</div></div>

<!-- 评论排行榜 -->
<div id="sidebar_topcommentedposts" class="sidebar-block"><div class="catListFeedback">
    <h3 class="catListTitle">
        <a href="https://www.cnblogs.com/wongbingming/most-commented" class="sidebar-card-title-a">评论排行榜</a>

    </h3>
    <div id="TopFeedbackPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/wongbingming/p/9085268.html">
                            1. Python并发编程之深入理解yield from语法（八）(8)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/wongbingming/p/9035579.html">
                            2. Python并发编程之线程消息通信机制任务协调（四）(7)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/wongbingming/p/11002978.html">
                            3. 花了两个星期，我终于把 WSGI 整明白了(6)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/wongbingming/p/13212306.html">
                            4. 全网最详细的 tcpdump 使用指南(5)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/wongbingming/p/9114171.html">
                            5. Python并发编程之学习异步IO框架：asyncio 中篇（十）(5)
                        </a>
                    </li>
        </ul>
    </div>
</div></div>

<!-- 推荐排行榜 -->
<div id="sidebar_topdiggedposts" class="sidebar-block">
<div id="topdigg_posts_wrap">
    <div class="catListView">
        <h3 class="catListTitle">
            <a href="https://www.cnblogs.com/wongbingming/most-liked" class="sidebar-card-title-a">推荐排行榜</a>

        </h3>
        <div id="TopDiggPostsBlock">
            <ul style="word-break: break-all">
                        <li>
                            <a href="https://www.cnblogs.com/wongbingming/p/9085268.html">
                                1. Python并发编程之深入理解yield from语法（八）(15)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/wongbingming/p/10519553.html">
                                2. 深入理解 Python 中的上下文管理器(10)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/wongbingming/p/11002978.html">
                                3. 花了两个星期，我终于把 WSGI 整明白了(8)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/wongbingming/p/11086773.html">
                                4. 从0到1：全面理解RPC远程调用(7)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/wongbingming/p/9114171.html">
                                5. Python并发编程之学习异步IO框架：asyncio 中篇（十）(7)
                            </a>
                        </li>
            </ul>
        </div>
    </div>
</div></div><div id="sidebar_recentcomments" class="sidebar-block"><div class="catListComment">
<h3 class="catListTitle"><a href="https://www.cnblogs.com/wongbingming/comments" class="sidebar-card-title-a">最新评论</a></h3>
    <div class="RecentCommentBlock">
        <ul>
                <li class="recent_comment_title"><a href="https://www.cnblogs.com/wongbingming/p/12854618.html">1. Re:求你了，别再使用 pprint 打印字典了</a></li>
                <li class="recent_comment_body"><p>然而json不支持自定义类</p>
</li>
                <li class="recent_comment_author">--23Xor</li>
                <li class="recent_comment_title"><a href="https://www.cnblogs.com/wongbingming/p/13035179.html">2. Re:26. Go 语言中通道死锁经典错误案例详解</a></li>
                <li class="recent_comment_body">你好，关于错误实例三，为什么新启一个协程来range通道就不会报错呢，代码如下： package main import ( "fmt" ) func main(){ ch := make(chan ...</li>
                <li class="recent_comment_author">--yyler</li>
                <li class="recent_comment_title"><a href="https://www.cnblogs.com/wongbingming/p/13212306.html">3. Re:全网最详细的 tcpdump 使用指南</a></li>
                <li class="recent_comment_body"><p>666</p>
</li>
                <li class="recent_comment_author">--宾客斯的美酒v</li>
                <li class="recent_comment_title"><a href="https://www.cnblogs.com/wongbingming/p/13819905.html">4. Re:超详细图解：从 0 搭建一个个人网站，也太简单了吧</a></li>
                <li class="recent_comment_body"><p>太麻烦了用 pagepan.com 建站一个邮箱搞定</p>
</li>
                <li class="recent_comment_author">--飞屋设计</li>
                <li class="recent_comment_title"><a href="https://www.cnblogs.com/wongbingming/p/11086773.html">5. Re:从0到1：全面理解RPC远程调用</a></li>
                <li class="recent_comment_body"><p>棒！</p>
</li>
                <li class="recent_comment_author">--戳人痛处</li>
        </ul>
    </div>
</div>

</div>


</div>
                    <script>loadBlogSideColumn();</script>
			</div>			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		<!--done-->
Copyright © 2022 王一白
<br><span id="poweredby">Powered by .NET 6 on Kubernetes</span>



	<div> Powered By <a href="https://www.cnblogs.com/" target="_blank">Cnblogs</a> |
            Theme <a href="https://github.com/esofar/cnblogs-theme-silence" target="_blank">Silence v1.1.2</a></div><div> Powered By <a href="https://www.cnblogs.com/" target="_blank">Cnblogs</a> |
            Theme <a href="https://github.com/esofar/cnblogs-theme-silence" target="_blank">Silence v1.1.2</a></div></div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->





<input type="hidden" id="antiforgery_token" value="CfDJ8EOBBtWq0dNFoDS-ZHPSe50u898lSJ_lW5nEOSuiGBFMLJKSwj2iM8taEHuixXTSV1XWzDETdG94L0rzCQeIV-tru6qkEYa_d-H__0o_BY-eNWDNE035FnvKSiHw9SgMEViJaOhyv0sL36QBNUPfMJ4">
<script async="" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    var kv = getGACustom();
    if (kv) {
        gtag('set', kv);
    }
    gtag('config', 'UA-476124-1');
</script>
<script defer="" src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/hm.js.下载"></script><iframe src="./全网最详细的 tcpdump 使用指南 - 王一白 - 博客园_files/container.html" style="visibility: hidden; display: none;"></iframe>

<script type="text/javascript">
    $.silence();
</script><button class="esa-follow-button" style="display: block;">关注</button><script type="text/javascript">
    $.silence({
        catalog: {
            enable: true,
            move: true,
            index: true,
            level1: 'h2',
            level2: 'h3',
            level3: 'h4',
        },
        signature: {
            enable: true,
            author: 'MING - Python编程时光',
            home: 'https://esofar.cn',
            license: '署名 4.0 国际',
            link: 'https://creativecommons.org/licenses/by/4.0'
        },
        reward: {
            enable: true,
            title: '一个专注分享Python知识的地方',
            wechat: 'http://image.python-online.cn/FqErvD_LXOE5V3kQoIMPNGptwKGA'
        },        
        github: {
            enable: true,
            color: '#fff',
            fill: '#151513',
            link: 'https://github.com/BingmingWong',
        }
    });
</script><a href="https://github.com/BingmingWong" class="github-corner" title="Follow me on GitHub">
                        <svg width="60" height="60" viewBox="0 0 250 250" style="fill:#151513; color:#fff; z-index: 999999; position: fixed; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true">
                            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
                            <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
                            <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
                        </svg>
                    </a><div class="esa-catalog" style="left: 1326px; top: 119px; right: auto;">
                        <div class="esa-catalog-tab" style="display: block;"><h2>目录</h2></div>
                        <div class="esa-catalog-contents" style="display: none;">
                            <div class="esa-catalog-title"><h2>目录</h2></div>
                            <a class="esa-catalog-close">×</a>
                        <ul><li class="li_h2" title="1. tcpdump 核心参数图解&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_0"></i><a class="esa-anchor-link"><span class="level1">1. </span>1. tcpdump 核心参数图解<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h2" title="2. 理解 tcpdump 的输出&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_1"></i><a class="esa-anchor-link"><span class="level1">2. </span>2. 理解 tcpdump 的输出<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="2.1 输出内容结构&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_2"></i><a class="esa-anchor-link"><span class="level2">2.1. </span>2.1 输出内容结构<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="2.2 Flags 标识符&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_3"></i><a class="esa-anchor-link"><span class="level2">2.2. </span>2.2 Flags 标识符<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h2" title="3. 常规过滤规则&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_4"></i><a class="esa-anchor-link"><span class="level1">3. </span>3. 常规过滤规则<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="3.1 基于IP地址过滤：host&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_5"></i><a class="esa-anchor-link"><span class="level2">3.1. </span>3.1 基于IP地址过滤：host<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="3.2 基于网段进行过滤：net&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_6"></i><a class="esa-anchor-link"><span class="level2">3.2. </span>3.2 基于网段进行过滤：net<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="3.3 基于端口进行过滤：port&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_7"></i><a class="esa-anchor-link"><span class="level2">3.3. </span>3.3 基于端口进行过滤：port<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="3.4 基于协议进行过滤：proto&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_8"></i><a class="esa-anchor-link"><span class="level2">3.4. </span>3.4 基于协议进行过滤：proto<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="3.5 基本IP协议的版本进行过滤&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_9"></i><a class="esa-anchor-link"><span class="level2">3.5. </span>3.5 基本IP协议的版本进行过滤<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h2" title="4. 可选参数解析&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_10"></i><a class="esa-anchor-link"><span class="level1">4. </span>4. 可选参数解析<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="4.1 设置不解析域名提升速度&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_11"></i><a class="esa-anchor-link"><span class="level2">4.1. </span>4.1 设置不解析域名提升速度<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="4.2 过滤结果输出到文件&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_12"></i><a class="esa-anchor-link"><span class="level2">4.2. </span>4.2 过滤结果输出到文件<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="4.3 从文件中读取包数据&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_13"></i><a class="esa-anchor-link"><span class="level2">4.3. </span>4.3 从文件中读取包数据<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="4.4 控制详细内容的输出&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_14"></i><a class="esa-anchor-link"><span class="level2">4.4. </span>4.4 控制详细内容的输出<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="4.5 控制时间的显示&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_15"></i><a class="esa-anchor-link"><span class="level2">4.5. </span>4.5 控制时间的显示<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="4.6 显示数据包的头部&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_16"></i><a class="esa-anchor-link"><span class="level2">4.6. </span>4.6 显示数据包的头部<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="4.7 过滤指定网卡的数据包&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_17"></i><a class="esa-anchor-link"><span class="level2">4.7. </span>4.7 过滤指定网卡的数据包<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="4.8 过滤特定流向的数据包&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_18"></i><a class="esa-anchor-link"><span class="level2">4.8. </span>4.8 过滤特定流向的数据包<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="4.9 其他常用的一些参数&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_19"></i><a class="esa-anchor-link"><span class="level2">4.9. </span>4.9 其他常用的一些参数<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="4.10 对输出内容进行控制的参数&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_20"></i><a class="esa-anchor-link"><span class="level2">4.10. </span>4.10 对输出内容进行控制的参数<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h2" title="5. 过滤规则组合&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_21"></i><a class="esa-anchor-link"><span class="level1">5. </span>5. 过滤规则组合<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h2" title="6. 特殊过滤规则&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_22"></i><a class="esa-anchor-link"><span class="level1">6. </span>6. 特殊过滤规则<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="5.1 根据 tcpflags 进行过滤&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_23"></i><a class="esa-anchor-link"><span class="level2">6.1. </span>5.1 根据 tcpflags 进行过滤<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="5.2  基于包大小进行过滤&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_24"></i><a class="esa-anchor-link"><span class="level2">6.2. </span>5.2  基于包大小进行过滤<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="5.3 根据 mac 地址进行过滤&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_25"></i><a class="esa-anchor-link"><span class="level2">6.3. </span>5.3 根据 mac 地址进行过滤<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="5.4 过滤通过指定网关的数据包&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_26"></i><a class="esa-anchor-link"><span class="level2">6.4. </span>5.4 过滤通过指定网关的数据包<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="5.5 过滤广播/多播数据包&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_27"></i><a class="esa-anchor-link"><span class="level2">6.5. </span>5.5 过滤广播/多播数据包<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h2" title="7. 如何抓取到更精准的包？&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_28"></i><a class="esa-anchor-link"><span class="level1">7. </span>7. 如何抓取到更精准的包？<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h2" title="8. 抓包实战应用例子&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_29"></i><a class="esa-anchor-link"><span class="level1">8. </span>8. 抓包实战应用例子<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="8.1 提取 HTTP 的 User-Agent&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_30"></i><a class="esa-anchor-link"><span class="level2">8.1. </span>8.1 提取 HTTP 的 User-Agent<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="8.2 抓取 HTTP GET 和 POST 请求&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_31"></i><a class="esa-anchor-link"><span class="level2">8.2. </span>8.2 抓取 HTTP GET 和 POST 请求<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="8.3 找出发包数最多的 IP&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_32"></i><a class="esa-anchor-link"><span class="level2">8.3. </span>8.3 找出发包数最多的 IP<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="8.4 抓取 DNS 请求和响应&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_33"></i><a class="esa-anchor-link"><span class="level2">8.4. </span>8.4 抓取 DNS 请求和响应<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="8.5 切割 pcap 文件&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_34"></i><a class="esa-anchor-link"><span class="level2">8.5. </span>8.5 切割 pcap 文件<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="8.6 提取 HTTP POST 请求中的密码&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_35"></i><a class="esa-anchor-link"><span class="level2">8.6. </span>8.6 提取 HTTP POST 请求中的密码<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="8.7 提取 HTTP 请求的 URL&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_36"></i><a class="esa-anchor-link"><span class="level2">8.7. </span>8.7 提取 HTTP 请求的 URL<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="8.8 抓取 HTTP 有效数据包&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_37"></i><a class="esa-anchor-link"><span class="level2">8.8. </span>8.8 抓取 HTTP 有效数据包<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h3" title="8.9 结合 Wireshark 进行分析&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_38"></i><a class="esa-anchor-link"><span class="level2">8.9. </span>8.9 结合 Wireshark 进行分析<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li><li class="li_h2" title="9. 参考文章&lt;button class=" cnblogs-toc-button"="" aria-expanded="false">"&gt;
                            <i class="idx_39"></i><a class="esa-anchor-link"><span class="level1">9. </span>9. 参考文章<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></a>
                        </li></ul></div>
                    </div><div class="esa-reward">
                <div class="esa-reward-close">+</div>
                <h2>"一个专注分享Python知识的地方"</h2>
                <div class="esa-reward-container"><div class="wechat"><img src="http://image.python-online.cn/FqErvD_LXOE5V3kQoIMPNGptwKGA" alt="微信支付"></div></div></div><button class="esa-follow-button" style="display: block;">关注</button><script type="text/javascript">getFollowStatus('07e57221-9b21-e711-9fc1-ac853d9f53cc');</script></body></html>